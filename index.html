<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SofaOffside - √Årbitro de Sill√≥n</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div id="top-bar">
        <div class="logo"><span class="sofa">Sofa</span><span class="offside">Offside</span></div>
        <div class="controls">
            <button id="nav-analysis" class="nav-btn active">‚öΩ An√°lisis</button>
            <button id="nav-challenge" class="nav-btn">üèÜ Challenge</button>
        </div>
    </div>

    <div id="analysis-view">
        <div id="start-screen">
            <img src="Imagenes_Generales/Tipito_solo1.png" alt="SofaOffside Mascot" class="main-mascot">

            <div class="logo" style="font-size: 3rem; margin-bottom: 20px;">
                <span class="sofa">Sofa</span><span class="offside">Offside</span>
            </div>
            <p>Herramienta de precisi√≥n para √°rbitros de sill√≥n.</p>
            
            <label for="file-input" class="big-upload-btn">üìÇ SUBIR IMAGEN</label>
            <input type="file" id="file-input" accept="image/*">

            <label for="video-input" class="big-upload-btn" id="btn-upload-video">üé¨ SUBIR VIDEO</label>
            <input type="file" id="video-input" accept="video/*">
        </div>

        <div id="workspace">
            <canvas id="canvas"></canvas>
            
            <div id="canvas-top-controls" class="hidden">
                <button id="btn-float-reset">üîÑ Reiniciar An√°lisis</button>
                <button id="btn-float-new">üìÇ Nueva Imagen</button>
            </div>
            
            <div id="analysis-tools-panel">
                <div id="instruction-box">Cargando instrucciones...</div>
                
                <button id="btn-mark-point" class="big-upload-btn hidden" style="background:#ffc107; color:black; padding: 15px; font-size: 1.2rem; border-radius: 8px; width: 100%;">üéØ MARCAR PUNTO</button>
                
                <div id="mode-selector">
                    <button id="mode-foot" class="mode-btn active">ü¶∂ Pie</button>
                    <button id="mode-body" class="mode-btn">üëï Cuerpo</button>
                </div>
                
                <select id="attack-dir-select" style="display:none; padding:10px; border-radius:5px; font-size:1rem;">
                    <option value="right">El Ataque va hacia la DERECHA &rarr;</option>
                    <option value="left">&larr; El Ataque va hacia la IZQUIERDA</option>
                </select>

                <button id="btn-evaluate-big">üîç ANALIZAR OFFSIDE</button>

                <div id="result-actions-block" style="display:none; width:100%; flex-direction:column; gap:8px;">
                     <div style="display: flex; gap: 8px; width: 100%;">
                        <button id="btn-toggle-stats" class="action-btn-compact" style="background:#333; color:#ccc; border:1px solid #555;">üìä Datos</button>
                        <button id="btn-download" class="action-btn-compact" style="background:#007bff; color:white; flex:2;">‚¨á Descargar Imagen</button>
                    </div>
                    <div id="sofa-stats-box">
                        <div class="stat-row"><span>Distancia:</span> <span class="stat-val" id="stat-dist">--</span></div>
                        <div class="stat-row"><span>P√≠xeles:</span> <span class="stat-val" id="stat-px">--</span></div>
                        <div class="stat-row"><span>M√©todo:</span> <span class="stat-val" id="stat-ref" style="color:#aaa; font-weight:normal; font-size:0.8rem;">--</span></div>
                        <div id="sofa-verdict">...</div>
                    </div>
                </div>

                <div id="post-analysis-buttons" style="display:none; gap:10px; width:100%; margin-top:5px;">
                    <button id="btn-post-reset" class="big-upload-btn" style="background: #ffc107; color: black; flex:1; font-size:1rem; padding:10px;">üîÑ Reiniciar</button>
                    <button id="btn-post-new" class="big-upload-btn" style="background: #555; color: white; flex:1; font-size:1rem; padding:10px;">üìÇ Nueva</button>
                </div>
            </div>

            <div id="result-container">
                <div id="result-badge"></div>
            </div>
        </div>
        <div id="zoom-lens"></div>

        <div id="video-picker-view" class="hidden">
            <div id="video-container">
                <video id="main-video" playsinline controls></video>
            </div>
            <div id="video-controls-bar">
                <p style="color:#aaa; font-size:0.9rem; margin-bottom:5px;">Busca el momento del pase</p>
                <div class="precision-controls">
                    <button class="btn-seek" id="btn-seek-back">‚è™</button>
                    <button id="btn-seek-fwd">‚è©</button>
                    <button id="btn-capture-frame">üì∏ CAPTURAR MOMENTO</button>
                </div>
                <button onclick="closeVideoPicker()" style="background:transparent; color:#777; font-size:0.8rem; margin-top:5px;">Cancelar</button>
            </div>
        </div>
    </div>

    <div id="challenge-view" class="hidden">
        <div id="challenge-content-area">
            <div id="challenge-intro" class="challenge-section">
                <img src="Imagenes_Generales/Tipito_challenge.png" alt="Challenge Mascot" class="main-mascot">
                
                <div class="logo" style="font-size: 3.5rem; margin-bottom: 20px;">
                    <span class="sofa">OFFSIDE</span><span class="offside"> CHALLENGE</span>
                </div>
                <h3>10 JUGADAS - 10 SEGUNDOS</h3>
                <p style="color:#aaa; margin-bottom: 30px;">Demuestra que sabes m√°s que el VAR.</p>
                <input type="text" id="username-input" class="challenge-input" placeholder="Tu Nombre de √Årbitro">
                <br><button id="btn-start-challenge" class="big-upload-btn" style="padding: 20px 50px;">PITAZO INICIAL üèÅ</button>
            </div>
            <div id="challenge-game" class="challenge-section hidden">
                <div style="display:flex; justify-content:space-between; width:100%; margin-bottom:5px; font-weight:bold;">
                    <span>JUGADA <span id="current-round" style="color:#ffc107;">1</span>/10</span>
                    <span>PUNTOS: <span id="live-score">0</span></span>
                </div>
                <div id="game-image-container">
                    <img id="challenge-image" src="" alt="Jugada">
                    <button id="btn-mute" title="Sonido">üîä</button>
                    <div id="ready-overlay" class="hidden">3</div>
                    <p id="loading-msg" style="position:absolute; color:white;">Cargando VAR...</p>
                    <div id="game-feedback-overlay">
                        <div class="feedback-top-bar"><span id="fb-icon">‚úÖ</span><span id="fb-title">¬°CORRECTO!</span></div>
                        <div class="feedback-bottom-bar"><span id="fb-subtitle">+150 Puntos</span><span id="fb-next">Siguiente en 3...</span></div>
                    </div>
                </div>
                <div id="debug-error-msg"></div>
                <div id="timer">10.0</div>
                <div id="game-buttons">
                    <button id="btn-game-offside" class="game-btn">‚ùå OFFSIDE</button>
                    <button id="btn-game-onside" class="game-btn">‚úÖ HABILITADO</button>
                </div>
            </div>
            <div id="challenge-ranking-final" class="challenge-section hidden">
                <h2>üèÅ FIN DEL PARTIDO üèÅ</h2>
                <p>Tu puntaje final:</p>
                <div style="font-size: 4rem; font-weight:900; color:#ffc107; margin-bottom: 20px;" id="final-score-display">0</div>
                <button id="btn-restart-challenge" class="big-upload-btn">JUGAR DE NUEVO</button>
            </div>
        </div>
        <div id="challenge-sidebar">
            <h3 class="ranking-title">üèÜ TOP 10 MUNDIAL</h3>
            <table class="sidebar-table"><thead><tr><th>#</th><th>Jugador</th><th style="text-align:right;">Pts</th></tr></thead><tbody id="sidebar-ranking-body"></tbody></table>
            <div style="margin-top:auto; text-align:center; font-size:0.8rem; color:#555; padding-top:20px;">SofaOffside.com.ar</div>
        </div>
    </div>

<script type="module" src="script.js"></script>
</body>
</html>
